@model List<ProductOutputDto>

<div>
    <h2 class="text-center p-3 m-3"><span class="badge rounded-pill badge-primary p-3">محصولات غرفه</span></h2>
</div>

<div class="row m-5">
    @foreach (var product in Model)
    {
        <div class="col-4">
            <div class="card h-100">
                @if (product.ProductPhotos.Any())
                {
                    <img src="\@product.ProductPhotos.FirstOrDefault()?.FilePath" class="card-img-top" alt="@product.Name" style="height:280px; width:auto;" />
                }

                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-truncate">@product.Name</h5>
                    <div>
                        <span class="card-text text-center badge rounded-pill bg-primary text-dark m-1 p-3">قیمت: @product.Price.ToString("N0") تومان</span>
                    </div>
                    <div>
                        @if (product.Auctions.Any(a => a.IsRunning))
                        {
                            // Product has ongoing auctions, display bidding option
                            <a href="@Url.Action("RegisterBid", "Product", new { productId = product.Id })" class="btn btn-secondary col-12 text-dark mt-auto w-80">ثبت پیشنهاد</a>
                        }
                        else
                        {
                            // No ongoing auctions, display direct purchase option
                            <div class="d-flex justify-content-center">
                                <a href="@Url.Action("Purchase", "Product", new { productId = product.Id })" class="btn btn-secondary col-12 text-dark mb-1 mt-auto w-80">خرید کردن</a>
                            </div>
                        }
                        <a href="@Url.Action("Details", "Product", new { productId = product.Id })" class="btn btn-secondary col-12 text-dark mt-auto w-80">جزئیات محصول</a>
                    </div>
                </div>

            </div>
        </div>
    }
</div>
